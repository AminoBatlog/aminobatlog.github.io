---
title: 区块链笔记 权益证明
key: blockchain20211222
tags:
  Blockchain
  ETH
---

区块链笔记7:

权益证明

笔记记录来源B站[北京大学肖臻老师《区块链技术与应用》公开课]https://www.bilibili.com/video/BV1Vt411X7JF

<!--more-->

---

Proof of work收到的普遍的批评是浪费电

下面是BTC的能耗数据

![img](/assets/images/2021-12-22/btc energy consumption.png)

下面是ETH的能耗数据

![img](/assets/images/2021-12-22/eth energy consumption.png)

既然挖矿需要购买设备, 买的设备越好算力越高, 那不就相当于比拼谁的钱多了, 为何不直接比钱呢

这种叫做virtual mining

未来权益证明是按照每个人持有的货币量投票的

优点:

不需要挖矿了, 减少了电的消耗, 减少了温室气体的排放

对于纯挖矿的币种的话, 因为购买的矿机之类的, 是在虚拟货币生态圈之外的, 从而导致很容易从外部收到攻击. BTC这种大币种因为够大没啥关系, 但是如果是小币种, 刚发行不久的时候就被攻击, 那这种攻击是致命的, 也称作AltCoin Infanticide

如果采用权益证明, 如果攻击者试图攻击, 必须得拥有整个系统50%以上的虚拟货币才能发动攻击, 无法简单的从外部进行攻击. 如果有人大量买入这个币种, 那这个币的价格会大涨. 所以权益证明是一个保护虚拟货币的闭环

权益证明里, 所持有的币越多, 挖矿的难度就越低, 但是不能简简单单的就降低难度, 因为这样只要你的币够多, 你的难度就足够低. 所以有些会锁定你的币一段时间, 例如你投入一定量的币在挖矿里用于降低难度, 那这些币就会被锁定一段时间. 这种也叫做proof of deposit



权益证明面临的挑战

nothing at stake

![img](/assets/images/2021-12-22/nothing at stake.png)

在工作量证明里, 如果出现了分叉, 那并不会想着两条链一起挖, 因为算力会分散

但是在权益证明里, 出现了分叉, 可以进行两头挖, 因为假如其中一条链最终成为了最长合法链, 那么你在另一条链里投入的币不受印象, 因为只会在另一条链里有记录, 这些币依旧可以正常使用

ETH中**准备采用的权益证明协议叫做Casper the Friendly Finality Gadget(FFG)**

finality是一种最终的状态, 包含其中的交易不会被取消, 单纯基于PoW的是有可能被回滚的

Casper的做法是引入一个概念, 叫做validator, 要想成为validator, 必须投入一定数量的ether作为保证金, 会被系统锁定住, validator的作用是协助系统达成共识, 投票的权重取决于保证金的大小. 挖矿的时候, 每挖出50个区块, 算作一个epoch, 然后要投票是否finality, 进行一轮投票, 都需要得到2/3的验证才能通过, 这个投票对于上一个epoch来说, 是个commit message, 对于下一个epoch来说, 是一个prepare message. 要连续两个epoch都得到2/3的投票, 才算有效

![img](/assets/images/2021-12-22/epoch.png)

验证者参与这个过程的好处是, 如果履行职责, 可以获得奖励, 如果验证者有不良行为, 会受到处罚

验证者有任期, 任期结束后如果完美的完成了任务, 可以拿回保证金以及奖励

**通过验证者投票达成的finality有没有可能被推翻?**

如果某个有恶意的矿工组织的话, 无法推翻已经达成的共识

只有大量的验证者给两边投票, 才有可能攻击成功, 而如果两边投票的话, 验证者的保证金会被全额没收